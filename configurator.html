<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D Configurator - Asem Abdelsalam</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="icon" href="images/logo.png" type="image/png">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        .configurator-section {
            padding: 8rem 0;
            background: #f5f5f5;
            text-align: center;
            min-height: 100vh;
        }
        .configurator-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
        }
        #upload-input {
            margin: 1rem 0;
            padding: 0.5rem;
            font-size: 1rem;
            font-family: 'Montserrat', sans-serif;
        }
        #model-viewer {
            width: 100%;
            height: 600px;
            border: 1px solid #eee;
            background: #fff;
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="container">
            <a href="/" class="logo" aria-label="Home">Asem Abdelsalam</a>
            <nav class="nav-menu" aria-label="Main navigation">
                <ul class="nav-list">
                    <li><a href="index.html">Home</a></li>
                    <li><a href="about.html">About</a></li>
                    <li><a href="#projects">Projects</a></li>
                    <li><a href="configurator.html" class="active">Configurator</a></li>
                    <li><a href="contact.html">Contact</a></li>
                    <li class="search-toggle" aria-label="Toggle search">
                        <svg class="search-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <circle cx="11" cy="11" r="8"></circle>
                            <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                        </svg>
                    </li>
                </ul>
                <button class="hamburger" aria-label="Toggle menu">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
            </nav>
        </div>
    </header>

    <div id="search-bar" class="search-bar" role="search">
        <div class="container">
            <input type="search" placeholder="Search projects..." id="search-input" aria-label="Search projects">
            <button class="close-search" aria-label="Close search">
                <svg class="close-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>
        </div>
    </div>

    <main>
        <section class="configurator-section">
            <div class="configurator-container">
                <h2>3D Configurator</h2>
                <input type="file" id="upload-input" accept=".glb,.gltf,.obj" aria-label="Upload 3D model">
                <div id="model-viewer" aria-label="3D model viewer"></div>
            </div>
        </section>
    </main>

    <footer class="footer">
        <div class="container">
            <p>Â© 2025 Asem Abdelsalam</p>
        </div>
    </footer>

    <!-- Load Three.js and extensions from unpkg CDN -->
    <script type="module">
        import * as THREE from 'https://unpkg.com/three@0.165.0/build/three.module.js';
        import { OrbitControls } from 'https://unpkg.com/three@0.165.0/examples/jsm/controls/OrbitControls.js';
        import { GLTFLoader } from 'https://unpkg.com/three@0.165.0/examples/jsm/loaders/GLTFLoader.js';
        import { OBJLoader } from 'https://unpkg.com/three@0.165.0/examples/jsm/loaders/OBJLoader.js';

        document.addEventListener('DOMContentLoaded', () => {
            const viewerDiv = document.getElementById('model-viewer');
            const uploadInput = document.getElementById('upload-input');

            // Set up Three.js scene
            const scene = new THREE.Scene();
            const camera = new THREE.PerspectiveCamera(75, viewerDiv.clientWidth / 600, 0.1, 1000);
            const renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(viewerDiv.clientWidth, 600);
            viewerDiv.appendChild(renderer.domElement);

            // Add lighting
            const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
            scene.add(ambientLight);
            const directionalLight = new THREE.DirectionalLight(0xffffff, 0.5);
            directionalLight.position.set(0, 1, 1);
            scene.add(directionalLight);

            // Add orbit controls
            const controls = new OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;
            controls.dampingFactor = 0.05;

            // Handle file upload
            uploadInput.addEventListener('change', (event) => {
                const file = event.target.files[0];
                if (!file) return;

                const fileType = file.name.split('.').pop().toLowerCase();
                const reader = new FileReader();

                reader.onload = (e) => {
                    const data = e.target.result;

                    if (fileType === 'glb' || fileType === 'gltf') {
                        const loader = new GLTFLoader();
                        loader.parse(data, '', (gltf) => {
                            scene.clear(); // Clear previous model
                            scene.add(gltf.scene);
                            camera.position.z = 5;
                            animate();
                        }, (error) => {
                            console.error('Error loading GLTF:', error);
                        });
                    } else if (fileType === 'obj') {
                        const loader = new OBJLoader();
                        const model = loader.parse(data);
                        scene.clear(); // Clear previous model
                        scene.add(model);
                        camera.position.z = 5;
                        animate();
                    }
                };

                if (fileType === 'obj') {
                    reader.readAsText(file);
                } else {
                    reader.readAsArrayBuffer(file);
                }
            });

            // Animation loop
            function animate() {
                requestAnimationFrame(animate);
                controls.update();
                renderer.render(scene, camera);
            }

            // Handle window resize
            window.addEventListener('resize', () => {
                camera.aspect = viewerDiv.clientWidth / 600;
                camera.updateProjectionMatrix();
                renderer.setSize(viewerDiv.clientWidth, 600);
            });

            // Initial camera position
            camera.position.z = 5;
        });
    </script>
    <script type="module" src="js/script.js" defer></script>
</body>
</html>